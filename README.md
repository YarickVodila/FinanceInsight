# FinanceInsight

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

–ù–∞—à–µ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π `RAG` –ø–∞–π–ø–ª–∞–π–Ω, –∫–æ—Ç–æ—Ä—ã –ø–æ–º–æ–∂–µ—Ç –æ—Ç–≤–µ—Ç–∏—Ç—å –≤–∞–º –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –æ —Ñ–∏–Ω–∞–Ω—Å–∞—Ö, —ç–∫–æ–Ω–æ–º–∏–∫—É, –±–∏–∑–Ω–µ—Å, –≤–∫–ª–∞–¥—ã. –¢–∞–∫–∂–µ –æ–Ω —Å–ø–æ—Å–æ–±–µ–Ω –Ω–∞–π—Ç–∏ –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ –∞–∫—Ç—ã –ø–æ –≤–∞—à–µ–º—É –∑–∞–ø—Ä–æ—Å—É –∫–∞—Å–∞–µ–º–æ —ç–∫–æ–Ω–æ–º–∏–∫–∏

## –î–∞–Ω–Ω—ã–µ

1. –î–∞–Ω–Ω—ã–µ –∏–∑ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö —Å—Ç–∞—Ç–µ–π, –∫–Ω–∏–≥ –∏ –∫—É—Ä—Å–æ–≤
    - Financial Markets and Institutions 7th ed. Frederic S. Mishkin, Stanley G. Eakins
    - Principles of macroeconomics 3th ed. David Shapiro, Daniel MacDonald, Steven A. Greenlaw
    - Principles of microeconomics 3th ed. David Shapiro, Daniel MacDonald, Steven A. Greenlaw
    - Principles of economics 3th ed. David Shapiro, Daniel MacDonald, Steven A. Greenlaw
    - Principles of Finance. Julie Danhlquist, Rainford Knight
    - Capital Markets And Securities Laws.
    - Securities Trading: Principles and Procedures. Joel Hasbrouck
    - –ö—É—Ä—Å—ã –ø–æ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π –≥—Ä–∞–º–æ—Ç–Ω–æ—Å—Ç–∏ –æ—Ç bks –∏ tinkoff
    - –ö–æ–¥–µ–∫—Å –†–§

2. –ù–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
    - [–ö–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç–ü–ª—é—Å](https://www.consultant.ru)

3. –ê–∫—Ç—É–∞–ª—å–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏ –ø—Ä–æ –±–∏–∑–Ω–µ—Å –∏ —Ñ–∏–Ω–∞–Ω—Å—ã
    - [Rambler finance](https://finance.rambler.ru/economics/)
    - [Tinkoff journal](https://journal.tinkoff.ru/flows/news/)
    - [RBC](https://www.rbc.ru/business/)


**P.S.** –ë–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ –æ–± —Å–±–æ—Ä–µ –∏ –∞–Ω–∞–ª–∏–∑–µ –¥–∞–Ω–Ω—ã—Ö –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ —ç—Ç–æ–π [—Å—Å—ã–ª–∫–µ](https://github.com/favead/financial-data-pipeline/tree/main)


## RAG Pipeline

![graph](graph.png)

## –û—Ü–µ–Ω–∫–∞ —Ä–µ—Ç—Ä–∏–≤–µ—Ä–∞

Abstract: –∫ 100 —Å–ª—É—á–∞–π–Ω—ã–º —á–∞–Ω–∫–∞–º –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –ö–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç+ (–∏—Å—Ç–æ—á–Ω–∏–∫ –≤—ã–±—Ä–∞–Ω –∫–∞–∫ —Å–∞–º—ã–π —Ä–µ–ª–µ–≤–∞—Ç–Ω—ã–π –¥–ª—è —Ä–µ—Ç—Ä–∏–≤–∞) –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–ª–∏—Å—å –≤–æ–ø—Ä–æ—Å—ã —Å –ø–æ–º–æ—â—å—é `mistral-large-latest`. –î–ª—è —Ä–µ—Ç—Ä–∏–≤–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å —Ñ—É–Ω–∫—Ü–∏—è retrieve_v1 –∞–Ω–∞–ª–æ–≥–∏—á–Ω–∞—è —Ç—É–ª—É retrieve –≤ FinanceMultiAgentRAG. –ü–æ –ø–æ–ª—É—á–µ–Ω–Ω—ã–º –¥–æ–∫—É–º–µ–Ω—Ç–∞–º —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–ª–∏—Å—å –º–µ—Ç—Ä–∏–∫–∏ precision@1, recall@2. 

–í –∫–∞—á–µ—Å—Ç–≤–µ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã —É—Å—Ä–µ–¥–Ω–µ–Ω–Ω—ã–µ precision@1 –∏ precision@2 –Ω–∞ 100 –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö: 
avg_precision@1 = 0.59
avg_recall@2 = 0.62

–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤ –Ω–æ—É—Ç–±—É–∫–µ `check_chunks.ipynb`

## –ú–µ—Ç—Ä–∏–∫–∏

–í –∫–∞—á–µ—Å—Ç–≤–µ –º–µ—Ç—Ä–∏–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å –º–µ—Ç–æ–¥–∏–∫–∞ `Response vs input` –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Å—É–¥—å–∏ –∫–æ—Ç–æ—Ä–æ–π –±—ã–ª–∞ –º–æ–¥–µ–ª—å `ministral-8b-latest`

>–í–æ–ø—Ä–æ—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –¥–ª—è –æ—Ü–µ–Ω–∫–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ —Ñ–∞–π–ª–µ `questions_for_metrics.json`. –†–∞—Å—á—ë—Ç –º–µ—Ç—Ä–∏–∫–∏ –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ —Ñ–∞–π–ª–µ `metrics.ipynb`

–í —Å—Ä–µ–¥–Ω–µ–º –ø–æ –æ—Ü–µ–Ω–∫–∏ `–°—É–¥—å–∏` –Ω–∞—à `RAG –ø–∞–π–ø–ª–∞–π–Ω` —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç –≤–µ—Å—å –≤–æ–ø—Ä–æ—Å –Ω–∞ `0.6289 %`


–ì–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞ –æ—Ü–µ–Ω–∫–∏ **–≤–æ–ø—Ä–æ—Å–æ–≤ - –æ—Ç–≤–µ—Ç–æ–≤**

![hist](hist.png)

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è 

1. –î–ª—è –Ω–∞—á–∞–ª–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–∫–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∫–æ–º–∞–Ω–¥–æ–π

    ```cmd
    git clone https://github.com/YarickVodila/FinanceInsight.git
    ```

2. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º `requirements.txt`
    ```cmd
    pip install -r requirements.txt
    ```

3. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö `FAISS`

    1. –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ —Ñ–∞–π–ª `rag_pipeline.py` –∫–æ—Ç–æ—Ä—ã–π –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –ø–æ –ø—É—Ç–∏ `FinanceInsight/apps/rag_system/rag_pipeline.py`
    2. –í –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `FAISS_DB` –∑–∞–ø–∏—Å—ã–≤–∞–µ–º –ø—É—Ç—å –¥–æ –≤–∞—à–µ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö. **P.S.** —Å–∫–∞—á–∞—Ç—å –Ω–∞—à—É –±–∞–∑—É –º–æ–∂–Ω–æ [—Ç—É—Ç](https://drive.google.com/file/d/1ZJpODxrIUufjtp1993AEv5vnhhjtVp_3/view?usp=sharing)

4. –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –∫–ª–∞—Å—Å –∏ –ø–æ–ª—å–∑—É–µ–º—Å—è ü§©
    ```py
    import os
    from IPython.display import Markdown, Image
    from apps.rag_system.rag_pipeline import FinanceMultiAgentRAG

    with open("Your API Key for Mistral", "r") as f:
        os.environ["MISTRAL_API_KEY"] = f.readline()

    api_key = os.environ["MISTRAL_API_KEY"]

    pipeline = FinanceMultiAgentRAG(
        api_key = api_key
    )

    output = pipeline.get_response("–ß—Ç–æ —Ç–∞–∫–æ–µ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–∞—è –≥—Ä–∞–º–æ—Ç–Ω–æ—Å—Ç—å?")

    Markdown(output)
    ```


**P.S.** –ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã –ø–∞–π–ø–ª–∞–π–Ω–∞ –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ `testing_pipeline.ipynb`

## –ó–∞–ø—É—Å–∫

–í –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —ç–Ω–¥–ø–æ–∏–Ω—Ç `/generate` –ø–æ fastAPI, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∑–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç
```json
{
    "response": ...
}
```
–ï—Å–ª–∏ –º–æ–¥–µ–ª—å –Ω–µ –Ω–∞—à–ª–∞ –æ—Ç–≤–µ—Ç, –ª–∏–±–æ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –≤ –æ–±—Ä–∞–±–æ—Ç–∫–µ, —Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞

### –°–±–æ—Ä–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:
```bash
docker build -t finance-insight:1.0 .
```

### –ó–∞–ø—É—Å–∫ —Å –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏:
```bash
docker run -p 8000:8000 -v local-path-to/data/index:/app/data/index --env-file .env_vars --rm finance-insight:1.0
```
